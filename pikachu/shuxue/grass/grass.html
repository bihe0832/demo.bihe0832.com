<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />    
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache, must-revalidate">
    <meta http-equiv="Expires" content="0">
    <link rel="Shortcut Icon" href="https://cdn.bihe0832.com/images/zixie_32.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="author" CONTENT="å­å‹°(bihe0832), code@bihe0832.com" />
    <meta name="keywords" content="å­å‹°,bihe0832,å·¥å…·å’©" />
    <meta name="description" content="çš®å¡ä¸˜å­¦æ•°å­¦ä¹‹ç‰›åƒè‰é—®é¢˜æ¼”ç¤º" />
    <meta property="og:title" content="çš®å¡ä¸˜å­¦æ•°å­¦ä¹‹ç‰›åƒè‰é—®é¢˜æ¼”ç¤º" />
    <meta property="og:locale" content="en_US" />
    <meta name="google-site-verification" content="3wzNgbjvFNHkH-8QpougMZ0s9Y4GEjG49kEb49QQqpw" />
    <meta property="og:description" content="" />
    <link rel="canonical" href="https://blog.bihe0832.com/" />
    <meta property="og:url" content="https://blog.bihe0832.com/" />
    <meta property="og:site_name" content="å·¥å…·å’©" />
    <meta property="og:type" content="article" />
    <title>çš®å¡ä¸˜å­¦æ•°å­¦ä¹‹ç‰›åƒè‰é—®é¢˜æ¼”ç¤º</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #2e7d32, #81c784);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            width: 100%;
            max-width: 1400px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            margin: 20px 0;
            padding: 20px;
        }
        header {
            background: linear-gradient(90deg, #1b5e20, #388e3c);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        header h2 {
            font-size: 2.2rem;
            margin: 10px 0;
            letter-spacing: 1px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.4);
        }
        
        /* ä¸‰æ å¸ƒå±€ */
        .main-content {
            display: flex;
            gap: 20px;
            height: 660px;
            overflow: hidden;
        }
        
        /* å·¦ä¾§ï¼šè®¾ç½®å’Œæ§åˆ¶ */
        .left-panel {
            width: 320px;
            flex-shrink: 0;
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        
        /* ä¸­é—´ï¼šåŠ¨ç”»åŒºåŸŸ */
        .center-panel {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* å³ä¾§ï¼šæ­¥éª¤åˆ—è¡¨ */
        .right-panel {
            width: 380px;
            flex-shrink: 0;
            background: #e8f5e9;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .panel-title {
            font-size: 1.1rem;
            color: #1b5e20;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 3px solid #4caf50;
            display: flex;
            align-items: center;
            position: relative;
        }
        .panel-title i {
            margin-right: 10px;
            font-size: 1.2rem;
            color: #4caf50;
        }
        
        .formula-card {
            padding: 0 12px 12px 12px;
            margin-bottom: 15px;
            flex-shrink: 0;
        }
        .formula-card .formula {
            font-size: 0.9rem;
            color: #1b5e20;
            margin: 8px 0;
        }
        
        .time-selector {
            margin: 10px 0 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .time-btn {
            padding: 10px 15px;
            background: linear-gradient(45deg, #e0e0e0, #bdbdbd);
            color: #333;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }
        .time-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .time-btn.active {
            background: linear-gradient(45deg, #4caf50, #1b5e20);
            color: white;
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.4);
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        .input-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .input-label {
            font-weight: bold;
            color: #1b5e20;
            font-size: 0.9rem;
            white-space: nowrap;
            min-width: 100px;
        }
        input {
            flex: 1;
            min-width: 0;
            padding: 10px 12px;
            border: 2px solid #4caf50;
            border-radius: 10px;
            font-size: 1rem;
            text-align: center;
            transition: all 0.3s;
        }
        input:focus {
            border-color: #ff9800;
            outline: none;
            box-shadow: 0 0 8px rgba(255, 152, 0, 0.3);
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }
        
        button {
            padding: 15px 20px;
            font-size: 1.1rem;
            background: linear-gradient(90deg, #4caf50, #1b5e20);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s, background 0.3s;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
            background: linear-gradient(90deg, #1b5e20, #4caf50);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            background: linear-gradient(90deg, #bdc3c7, #95a5a6);
            cursor: not-allowed;
            transform: none;
        }
        
        .start-btn {
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            box-shadow: 0 4px 10px rgba(39, 174, 96, 0.3);
        }
        .start-btn:hover {
            background: linear-gradient(90deg, #2ecc71, #27ae60);
        }
        
        .show-all-btn {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(155, 89, 182, 0.3);
            padding: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .show-all-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }
        .show-all-btn:disabled {
            background: linear-gradient(90deg, #bdc3c7, #95a5a6);
            cursor: not-allowed;
            transform: none;
        }
        
        .nav-buttons {
            display: flex;
            gap: 10px;
        }
        .nav-buttons button {
            flex: 1;
            padding: 12px;
            font-size: 1rem;
        }
        
        /* è‰åœ°åŒºåŸŸ */
        .meadow-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }
        
        .meadow {
            flex: 1;
            min-height: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 20px;
            justify-content: flex-start;
            align-content: flex-start;
            border: 4px solid #558b2f;
            border-radius: 15px;
            background: linear-gradient(to bottom, #c8e6c9, #a5d6a7);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow-y: auto;
        }
        .meadow::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
            border-radius: 11px;
        }
        
        .grass-item {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            position: relative;
            z-index: 1;
        }
        
        .grass-item.eaten {
            opacity: 0.3;
            filter: grayscale(100%);
        }
        
        .cow-item {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            transform: scaleX(-1);
            z-index: 2;
            flex-shrink: 0;
        }
        
        .cow-item.eating {
            animation: eat 0.5s ease-in-out infinite;
        }
        
        .cow-item.hidden {
            display: none;
        }
        
        @keyframes eat {
            0%, 100% { transform: scaleX(-1) rotate(0deg) scale(1); }
            50% { transform: scaleX(-1) rotate(10deg) scale(1.1); }
        }
        
        .sun-moon {
            font-size: 24px;
        }
        
        .meadow-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: linear-gradient(90deg, #e8f5e9, #c8e6c9);
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        
        .day-indicator {
            font-weight: bold;
            color: #1b5e20;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .grass-count {
            font-weight: bold;
            color: #1b5e20;
            font-size: 1.1rem;
            background: rgba(255,255,255,0.8);
            padding: 5px 12px;
            border-radius: 15px;
        }
        
        /* æ­¥éª¤åˆ—è¡¨ */
        .steps-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-counter {
            background: #4caf50;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .steps-container {
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            padding: 15px;
            background: linear-gradient(to right, #c8e6c9, #a5d6a7);
            border-radius: 12px;
        }
        
        .steps-container::-webkit-scrollbar {
            width: 6px;
        }
        .steps-container::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
        }
        .steps-container::-webkit-scrollbar-thumb {
            background: #4caf50;
            border-radius: 3px;
        }
        
        .step {
            padding: 10px 0;
            transition: all 0.3s;
            font-size: 0.95rem;
            display: none;
            border-bottom: 1px dashed rgba(76, 175, 80, 0.4);
        }
        
        .step:last-child {
            border-bottom: none;
        }
        
        .step.visible {
            display: block;
            animation: fadeIn 0.4s ease;
        }
        
        .step.active {
            animation: breatheGreen 1.5s ease-in-out infinite;
        }
        
        @keyframes breatheGreen {
            0%, 100% { background-color: rgba(76, 175, 80, 0.1); }
            50% { background-color: rgba(76, 175, 80, 0.25); }
        }
        
        .step.empty {
            background-color: rgba(244, 67, 54, 0.15);
            border-left: 4px solid #f44336;
            padding-left: 10px;
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #4caf50;
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.8rem;
            margin-right: 10px;
        }
        
        .step.empty .step-number {
            background: #f44336;
        }
        
        .highlight {
            color: #d32f2f;
            font-weight: bold;
            background-color: #fff9c4;
            padding: 1px 4px;
            border-radius: 3px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .answer-box {
            margin-top: 15px;
            background: linear-gradient(135deg, #fff9c4, #ffeb3b);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            display: none;
            box-shadow: 0 4px 12px rgba(255, 235, 59, 0.4);
        }
        
        .answer-box.show {
            display: block;
            animation: pop 0.5s ease;
        }
        
        @keyframes pop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .answer-box h3 {
            color: #f57f17;
            font-size: 1.3rem;
            margin: 0;
        }
        
        /* å“åº”å¼å¸ƒå±€ */
        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
                height: auto;
            }
            .left-panel, .right-panel {
                width: 100%;
            }
            .left-panel {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 20px;
            }
            .left-panel .panel-title {
                width: 100%;
            }
            .time-selector {
                flex-direction: row;
                flex: 1;
            }
            .input-group {
                flex-direction: row;
                flex-wrap: wrap;
                flex: 2;
            }
            .input-item {
                flex: 1;
                min-width: 120px;
            }
            .controls {
                flex-direction: row;
                flex-wrap: wrap;
                width: 100%;
                margin-top: 10px;
            }
            .controls button {
                flex: 1;
                min-width: 120px;
            }
            .nav-buttons {
                flex: 2;
            }
            .center-panel {
                min-height: 350px;
            }
            .right-panel {
                min-height: 400px;
            }
        }
        
        @media (max-width: 700px) {
            .left-panel {
                flex-direction: column;
            }
            .time-selector {
                flex-direction: column;
            }
            .input-group {
                flex-direction: column;
            }
            .controls {
                flex-direction: column;
            }
            .nav-buttons {
                flex-direction: row;
            }
            .grass-item {
                width: 32px;
                height: 32px;
                font-size: 22px;
            }
            .cow-item {
                width: 32px;
                height: 32px;
                font-size: 28px;
            }
            header h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h2><i class="fas fa-seedling"></i> çš®å¡ä¸˜å­¦æ•°å­¦ä¹‹ç‰›åƒè‰é—®é¢˜æ¼”ç¤º</h2>
            <p>è‰åœ¨é•¿ç‰›åœ¨åƒï¼Œç”¨ä¸¤æ¬¡åƒè‰å·®æ±‚æ¯å¤©æ–°é•¿é‡</p>
        </header>
        
        <div class="main-content">
            <!-- å·¦ä¾§ï¼šè®¾ç½®å’Œæ§åˆ¶ -->
            <div class="left-panel">
                <div class="panel-title">
                    <i class="fas fa-cog"></i>
                    <span>é—®é¢˜è®¾ç½®</span>
                </div>
                
                <div class="time-selector">
                    <span class="time-btn active" onclick="toggleGrowTime('morning')">
                        <i class="fas fa-sun"></i> æ—©ä¸Šé•¿è‰
                    </span>
                    <span class="time-btn" onclick="toggleGrowTime('evening')">
                        <i class="fas fa-moon"></i> æ™šä¸Šé•¿è‰
                    </span>
                </div>

                <div class="input-group">
                    <div class="input-item">
                        <label class="input-label">åŸæœ‰è‰ï¼ˆæ–¤ï¼‰</label>
                        <input type="number" id="initialGrass" min="1" max="99999" value="10">
                    </div>
                    
                    <div class="input-item">
                        <label class="input-label">æ¯å¤©é•¿è‰ï¼ˆæ–¤ï¼‰</label>
                        <input type="number" id="growAmount" min="1" value="2">
                    </div>
                    
                    <div class="input-item">
                        <label class="input-label">æ¯å¤©åƒè‰ï¼ˆæ–¤ï¼‰</label>
                        <input type="number" id="eatAmount" min="1" value="5">
                    </div>
                </div>
                
                <div class="controls">
                    <div class="nav-buttons">
                        <button id="prevBtn" onclick="prevStep()" disabled>
                            <i class="fas fa-arrow-left"></i> ä¸Šä¸€æ­¥
                        </button>
                        <button id="nextBtn" onclick="nextStep()">
                            ä¸‹ä¸€æ­¥ <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <button id="autoBtn" onclick="autoPlay()">
                        <i class="fas fa-forward"></i> è‡ªåŠ¨æ’­æ”¾
                    </button>
                    <button class="show-all-btn" id="showAllBtn" onclick="showAllSteps()" disabled>
                        <i class="fas fa-eye"></i> ä¸€é”®æŸ¥çœ‹
                    </button>
                </div>
            </div>
            
            <!-- ä¸­é—´ï¼šåŠ¨ç”»åŒºåŸŸ -->
            <div class="center-panel">
                <div class="panel-title">
                    <i class="fas fa-leaf"></i>
                    <span>è‰åœ°åŠ¨ç”»</span>
                </div>
                <div class="meadow-container">
                    <div class="meadow-info">
                        <div class="day-indicator">
                            <span id="sunMoon">â˜€ï¸</span>
                            <span id="dayIndicator">å¼€å§‹å‰</span>
                        </div>
                        <div class="grass-count" id="grassCount">è‰ï¼š10 æ–¤</div>
                    </div>
                    <div class="meadow" id="meadow">
                        <div class="cow-item hidden" id="cow">ğŸ„</div>
                    </div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šæ­¥éª¤åˆ—è¡¨ -->
            <div class="right-panel">
                <div class="panel-title">
                    <i class="fas fa-calculator"></i>
                    <span>æ ¸å¿ƒå…¬å¼</span>
                </div>
                <div class="formula-card">
                    <div class="formula">â€¢ æ¯å¤©å‡€å‡å°‘ = åƒè‰é‡ - é•¿è‰é‡</div>
                    <div class="formula">â€¢ åƒå®Œå¤©æ•° = åŸæœ‰è‰ Ã· æ¯å¤©å‡€å‡å°‘</div>
                    <div class="formula">â€¢ æ¡ä»¶ï¼šåƒè‰é‡ > é•¿è‰é‡</div>
                </div>
                
                <div class="steps-header">
                    <div class="panel-title" style="margin-bottom: 0; border-bottom: none;">
                        <i class="fas fa-list-ol"></i>
                        <span>è§£é¢˜æ­¥éª¤</span>
                    </div>
                    <div class="step-counter">
                        <span id="step-counter">0</span>/<span id="total-steps">0</span>
                    </div>
                </div>
                <div class="steps-container" id="steps">
                    <div style="text-align: center; color: #666; padding: 40px 20px;">
                        ğŸ‘† ç‚¹å‡»ä¸‹ä¸€æ­¥å¼€å§‹è§£ç­”
                    </div>
                </div>
                <div class="answer-box" id="answerBox">
                    <h3>ğŸ‰ ç­”æ¡ˆ</h3>
                    <p style="margin: 5px 0 0 0; color: #f57f17;">ç¬¬ <span id="answerDay">0</span> å¤©è‰è¢«åƒå®Œ</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let stepsData = [];
        let currentStep = 0;
        let growTime = 'morning'; // morning æˆ– evening
        let isAutoPlaying = false;
        let autoPlayTimer = null;

        function toggleGrowTime(time) {
            growTime = time;
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.includes(time === 'morning' ? 'æ—©ä¸Š' : 'æ™šä¸Š'));
            });
        }

        function updateMeadow(grassAmount, showCow, isNight, dayText) {
            const meadow = document.getElementById('meadow');
            const sunMoon = document.getElementById('sunMoon');
            const grassCountEl = document.getElementById('grassCount');
            const cowEl = document.getElementById('cow');
            const dayIndicator = document.getElementById('dayIndicator');
            
            // æ›´æ–°æ—¥æœŸæŒ‡ç¤º
            dayIndicator.textContent = dayText || 'å¼€å§‹å‰';
            
            // æ›´æ–°å¤ªé˜³/æœˆäº®
            sunMoon.textContent = isNight ? 'ğŸŒ™' : 'â˜€ï¸';
            
            // æ›´æ–°è‰çš„æ•°é‡æ˜¾ç¤º
            grassCountEl.textContent = `è‰ï¼š${Math.max(0, grassAmount)} æ–¤`;
            
            // æ¸…é™¤æ—§çš„è‰
            const oldGrass = meadow.querySelectorAll('.grass-item');
            oldGrass.forEach(g => g.remove());
            
            // ç‰›å§‹ç»ˆæ˜¾ç¤ºï¼Œåªæ˜¯åƒè‰æ—¶æœ‰åŠ¨ç”»
            cowEl.classList.remove('hidden');
            if (showCow) {
                cowEl.classList.add('eating');
            } else {
                cowEl.classList.remove('eating');
            }
            
            // æŠŠç‰›æ”¾åˆ°æœ€å‰é¢
            meadow.insertBefore(cowEl, meadow.firstChild);
            
            // æ·»åŠ æ–°çš„è‰ï¼ˆæ¯æ–¤è‰ç”¨ä¸€ä¸ªemojiè¡¨ç¤ºï¼‰ï¼Œè‰è·Ÿåœ¨ç‰›åé¢
            const displayAmount = Math.max(0, grassAmount);
            for (let i = 0; i < displayAmount; i++) {
                const grass = document.createElement('div');
                grass.className = 'grass-item';
                grass.textContent = 'ğŸŒ¿';
                meadow.appendChild(grass);
            }
        }

        function createStep(text, grassAmount, showCow, isNight, stepNum, isEmpty, dayText) {
            const step = document.createElement('div');
            step.className = 'step' + (isEmpty ? ' empty' : '');
            if (stepNum === 0) step.classList.add('active');
            
            // é«˜äº®æ•°å­—
            const highlightedText = text.replace(/(\d+)/g, '<span class="highlight">$1</span>');
            
            step.innerHTML = `
                <span class="step-number">${stepNum + 1}</span>
                <span>${highlightedText}</span>
            `;
            
            step.dataset.grass = grassAmount;
            step.dataset.showCow = showCow;
            step.dataset.isNight = isNight;
            step.dataset.dayText = dayText;
            return step;
        }

        function generateSteps(initialGrass, growAmount, eatAmount) {
            const steps = [];
            let currentGrass = initialGrass;
            let day = 0;
            
            // åˆå§‹çŠ¶æ€
            steps.push([`å¼€å§‹æ—¶ï¼Œè‰åœ°ä¸Šæœ‰ ${initialGrass} æ–¤è‰`, initialGrass, false, false, steps.length, false, 'å¼€å§‹å‰']);
            
            // æ¨¡æ‹Ÿæ¯ä¸€å¤©
            while (currentGrass > 0) {
                day++;
                
                if (growTime === 'morning') {
                    // æ—©ä¸Šé•¿è‰
                    const beforeGrow = currentGrass;
                    currentGrass += growAmount;
                    steps.push([`ç¬¬ ${day} å¤©æ—©ä¸Šï¼šè‰é•¿äº† ${growAmount} æ–¤ï¼ˆ${beforeGrow} + ${growAmount} = ${currentGrass} æ–¤ï¼‰`, currentGrass, false, false, steps.length, false, `ç¬¬ ${day} å¤© æ—©ä¸Š`]);
                    
                    // æ™šä¸Šåƒè‰
                    const beforeEat = currentGrass;
                    currentGrass -= eatAmount;
                    if (currentGrass <= 0) {
                        steps.push([`ç¬¬ ${day} å¤©æ™šä¸Šï¼šç‰›åƒ ${eatAmount} æ–¤ï¼ˆ${beforeEat} - ${eatAmount} = ${currentGrass} æ–¤ï¼‰â†’ è‰è¢«åƒå®Œï¼`, Math.max(0, currentGrass), true, true, steps.length, true, `ç¬¬ ${day} å¤© æ™šä¸Š`]);
                        break;
                    } else {
                        steps.push([`ç¬¬ ${day} å¤©æ™šä¸Šï¼šç‰›åƒ ${eatAmount} æ–¤ï¼ˆ${beforeEat} - ${eatAmount} = ${currentGrass} æ–¤ï¼‰`, currentGrass, true, true, steps.length, false, `ç¬¬ ${day} å¤© æ™šä¸Š`]);
                    }
                } else {
                    // æ—©ä¸Šåƒè‰
                    const beforeEat = currentGrass;
                    currentGrass -= eatAmount;
                    if (currentGrass <= 0) {
                        steps.push([`ç¬¬ ${day} å¤©æ—©ä¸Šï¼šç‰›åƒ ${eatAmount} æ–¤ï¼ˆ${beforeEat} - ${eatAmount} = ${currentGrass} æ–¤ï¼‰â†’ è‰è¢«åƒå®Œï¼`, Math.max(0, currentGrass), true, false, steps.length, true, `ç¬¬ ${day} å¤© æ—©ä¸Š`]);
                        break;
                    } else {
                        steps.push([`ç¬¬ ${day} å¤©æ—©ä¸Šï¼šç‰›åƒ ${eatAmount} æ–¤ï¼ˆ${beforeEat} - ${eatAmount} = ${currentGrass} æ–¤ï¼‰`, currentGrass, true, false, steps.length, false, `ç¬¬ ${day} å¤© æ—©ä¸Š`]);
                    }
                    
                    // æ™šä¸Šé•¿è‰
                    const beforeGrow = currentGrass;
                    currentGrass += growAmount;
                    steps.push([`ç¬¬ ${day} å¤©æ™šä¸Šï¼šè‰é•¿äº† ${growAmount} æ–¤ï¼ˆ${beforeGrow} + ${growAmount} = ${currentGrass} æ–¤ï¼‰`, currentGrass, false, true, steps.length, false, `ç¬¬ ${day} å¤© æ™šä¸Š`]);
                }
                
                // é˜²æ­¢æ— é™å¾ªç¯
                if (day > 1000) {
                    alert('è®¡ç®—æ­¥éª¤è¿‡å¤šï¼Œè¯·è°ƒæ•´å‚æ•°ã€‚');
                    return { steps: [], finalDay: 0 };
                }
            }
            
            return { steps, finalDay: day };
        }

        function showStep(stepIndex) {
            document.getElementById('step-counter').textContent = stepIndex + 1;
            document.getElementById('prevBtn').disabled = stepIndex <= 0;
            document.getElementById('nextBtn').disabled = stepIndex >= stepsData.length - 1;
            
            // æ˜¾ç¤ºå½“å‰åŠä¹‹å‰çš„æ­¥éª¤ï¼Œéšè—ä¹‹åçš„æ­¥éª¤
            stepsData.forEach((step, index) => {
                step.classList.toggle('active', index === stepIndex);
                step.classList.toggle('visible', index <= stepIndex);
            });
            
            // æ»šåŠ¨åˆ°å½“å‰æ­¥éª¤
            const activeStep = stepsData[stepIndex];
            if (activeStep) {
                activeStep.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            
            const currentData = stepsData[stepIndex].dataset;
            updateMeadow(
                parseInt(currentData.grass),
                currentData.showCow === 'true',
                currentData.isNight === 'true',
                currentData.dayText
            );
            
            // å¦‚æœæ˜¯æœ€åä¸€æ­¥ï¼Œæ˜¾ç¤ºç­”æ¡ˆ
            if (stepIndex === stepsData.length - 1) {
                document.getElementById('answerBox').classList.add('show');
            } else {
                document.getElementById('answerBox').classList.remove('show');
            }
        }

        function nextStep() {
            // å¦‚æœè¿˜æ²¡æœ‰ç”Ÿæˆæ­¥éª¤ï¼Œå…ˆç”Ÿæˆ
            if (stepsData.length === 0) {
                startCalculation();
                return;
            }
            if (currentStep < stepsData.length - 1) {
                showStep(++currentStep);
            }
        }
        
        function prevStep() {
            if (currentStep > 0) {
                showStep(--currentStep);
            }
        }

        function autoPlay() {
            if (isAutoPlaying) {
                stopAutoPlay();
                return;
            }
            
            isAutoPlaying = true;
            document.getElementById('autoBtn').innerHTML = '<i class="fas fa-pause"></i> æš‚åœ';
            document.getElementById('prevBtn').disabled = true;
            document.getElementById('nextBtn').disabled = false;
            
            autoPlayTimer = setInterval(() => {
                if (currentStep < stepsData.length - 1) {
                    nextStep();
                } else {
                    stopAutoPlay();
                }
            }, 1200);
        }

        function stopAutoPlay() {
            isAutoPlaying = false;
            document.getElementById('autoBtn').innerHTML = '<i class="fas fa-forward"></i> è‡ªåŠ¨æ’­æ”¾';
            document.getElementById('prevBtn').disabled = currentStep <= 0;
            document.getElementById('nextBtn').disabled = currentStep >= stepsData.length - 1;
            document.getElementById('showAllBtn').disabled = stepsData.length === 0;
            
            if (autoPlayTimer) {
                clearInterval(autoPlayTimer);
                autoPlayTimer = null;
            }
        }

        function showAllSteps() {
            stopAutoPlay();
            
            // æ˜¾ç¤ºæ‰€æœ‰æ­¥éª¤
            stepsData.forEach((step, index) => {
                step.classList.add('visible');
                step.classList.toggle('active', index === stepsData.length - 1);
            });
            
            // è·³è½¬åˆ°æœ€åä¸€æ­¥
            currentStep = stepsData.length - 1;
            document.getElementById('step-counter').textContent = currentStep + 1;
            document.getElementById('prevBtn').disabled = false;
            document.getElementById('nextBtn').disabled = false;
            
            // æ›´æ–°è‰åœ°æ˜¾ç¤ºä¸ºæœ€ç»ˆçŠ¶æ€
            const lastData = stepsData[currentStep].dataset;
            updateMeadow(
                parseInt(lastData.grass),
                lastData.showCow === 'true',
                lastData.isNight === 'true',
                lastData.dayText
            );
            
            // æ˜¾ç¤ºç­”æ¡ˆ
            document.getElementById('answerBox').classList.add('show');
            
            // æ»šåŠ¨åˆ°æœ€åä¸€æ­¥
            stepsData[currentStep].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function startCalculation() {
            stopAutoPlay();
            
            const initialGrass = parseInt(document.getElementById('initialGrass').value);
            const growAmount = parseInt(document.getElementById('growAmount').value);
            const eatAmount = parseInt(document.getElementById('eatAmount').value);
            
            if (!initialGrass || !growAmount || !eatAmount || initialGrass < 1 || growAmount < 1 || eatAmount < 1) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ•°å€¼ï¼ˆéƒ½å¿…é¡»å¤§äº0ï¼‰');
                return;
            }
            
            if (growAmount > eatAmount) {
                alert('æ¯å¤©é•¿è‰çš„é‡å¿…é¡»å°äºæˆ–ç­‰äºåƒè‰çš„é‡ï¼Œå¦åˆ™è‰æ°¸è¿œåƒä¸å®Œï¼');
                return;
            }
            
            if (growAmount === eatAmount && initialGrass > 0) {
                alert('æ¯å¤©é•¿è‰é‡ç­‰äºåƒè‰é‡ï¼Œè‰æ°¸è¿œåƒä¸å®Œï¼');
                return;
            }
            
            const stepContainer = document.getElementById('steps');
            stepContainer.innerHTML = '';
            stepsData = [];
            
            const result = generateSteps(initialGrass, growAmount, eatAmount);
            if (result.steps.length === 0) return;
            
            result.steps.forEach(([text, grass, showCow, isNight, stepNum, isEmpty, dayText]) => {
                const stepEl = createStep(text, grass, showCow, isNight, stepNum, isEmpty, dayText);
                stepsData.push(stepEl);
                stepContainer.appendChild(stepEl);
            });
            
            document.getElementById('total-steps').textContent = stepsData.length;
            document.getElementById('answerDay').textContent = result.finalDay;
            document.getElementById('answerBox').classList.remove('show');
            document.getElementById('showAllBtn').disabled = false;
            
            currentStep = 0;
            showStep(currentStep);
        }
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        window.onload = function() {
            updateMeadow(10, false, false, 'å¼€å§‹å‰');
        };
    </script>
    <a href="../../index.html" style="display:block;text-align:center;margin:30px auto;color:#fff;text-decoration:none;font-size:14px;">â† è¿”å›çš®å¡ä¸˜å­¦ä¹ èµ„æº</a>
</body>
</html>
