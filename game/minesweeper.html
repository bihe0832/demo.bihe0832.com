<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç»å…¸æ‰«é›·æ¸¸æˆ</title>
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 10px;
            min-width: 0;
            touch-action: manipulation;
        }
        
        .page-container {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        h1 {
            color: #333;
            margin-bottom: 15px;
            text-align: center;
            width: 100%;
            font-size: 1.5rem;
        }
        
        .game-container {
            display: inline-block;
            background-color: #c0c0c0;
            padding: 10px;
            border: 4px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            margin-bottom: 20px;
            max-width: 100%;
            overflow: auto;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 5px 10px;
            background-color: #c0c0c0;
            border: 4px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
        }
        
        .counter {
            display: flex;
            background-color: black;
            color: red;
            font-family: monospace;
            font-size: 24px;
            padding: 2px 5px;
            border: 2px solid #808080;
            min-width: 70px;
            justify-content: center;
        }
        
        .face-button {
			width: 36px;
			height: 36px;
			font-size: 24px; /* é€‚å½“è°ƒæ•´å­—ä½“å¤§å° */
			cursor: pointer;
			background-color: #c0c0c0;
			border: 6px solid;
			border-color: #ffffff #808080 #808080 #ffffff;
			display: flex;
			justify-content: center;
			align-items: center;
			position: absolute;
			left: 50%;
			transform: translateX(-50%);
			padding: 0; /* ç¡®ä¿å†…è¾¹è·ä¸º0 */
			line-height: 1; /* é‡ç½®è¡Œé«˜ */
			box-sizing: border-box; /* åŒ…å«è¾¹æ¡†åœ¨å†…è®¡ç®—å°ºå¯¸ */
		}
        
        .face-button:active {
            border-color: #808080 #ffffff #ffffff #808080;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(var(--cols), minmax(30px, 1fr));
            grid-template-rows: repeat(var(--rows), minmax(30px, 1fr));
            gap: 1px;
            background-color: #808080;
            border: 4px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            touch-action: none;
        }
        
        .cell {
            width: 100%;
            height: 100%;
            min-width: 30px;
            min-height: 30px;
            background-color: #c0c0c0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            border: 3px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        .cell.revealed {
            background-color: #c0c0c0;
            border: 1px solid #808080;
        }
        
        .cell.mine {
            background-color: red;
        }
        
        .cell.flagged {
            background-color: #c0c0c0;
        }
        
        .number-1 { color: blue; }
        .number-2 { color: green; }
        .number-3 { color: red; }
        .number-4 { color: darkblue; }
        .number-5 { color: brown; }
        .number-6 { color: teal; }
        .number-7 { color: black; }
        .number-8 { color: gray; }
        
        .difficulty-selector {
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }
        
        .difficulty-selector button {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            min-width: 120px;
            border: 2px solid #808080;
            background-color: #c0c0c0;
        }
        
        .instructions {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background-color: #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
            font-size: 0.9rem;
        }
        
        .instructions h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #808080;
            padding-bottom: 8px;
            text-align: center;
            font-size: 1.2rem;
        }
        
        .instructions h3 {
            color: #444;
            margin-top: 15px;
            font-size: 1rem;
        }
        
        .instructions ul {
            padding-left: 18px;
            margin: 8px 0;
        }
        
        .instructions li {
            margin-bottom: 6px;
            line-height: 1.4;
        }
        
        @media (min-width: 600px) {
            .game-container {
                padding: 15px;
            }
            
            .game-header {
                padding: 8px 15px;
                margin-bottom: 15px;
            }
            
            .counter {
                font-size: 28px;
                min-width: 80px;
            }
            
            .face-button {
                width: 42px;
                height: 42px;
                font-size: 24px;
            }
            
            .cell {
                min-width: 36px;
                min-height: 36px;
                font-size: 1.4rem;
            }
            
            .difficulty-selector button {
                min-width: 140px;
                padding: 10px 15px;
                font-size: 1rem;
            }
        }
        
        @media (min-width: 768px) {
            h1 {
                font-size: 2rem;
                margin-bottom: 20px;
            }
            
            .game-container {
                padding: 20px;
            }
            
            .game-header {
                padding: 10px 20px;
                margin-bottom: 20px;
            }
            
            .counter {
                font-size: 36px;
                min-width: 100px;
            }
            
            .face-button {
                width: 48px;
                height: 48px;
                font-size: 24px;
            }
            
            .cell {
                min-width: 42px;
                min-height: 42px;
                font-size: 1.6rem;
            }
            
            .difficulty-selector button {
                min-width: 160px;
                padding: 12px 18px;
                font-size: 1.1rem;
            }
            
            .instructions {
                padding: 20px;
                font-size: 1rem;
            }
            
            .instructions h2 {
                font-size: 1.5rem;
            }
            
            .instructions h3 {
                font-size: 1.2rem;
            }
        }

		
        /* èƒœåˆ©å¼¹çª— - ç»å…¸æ‰«é›·é£æ ¼ */
        .victory-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .victory-content {
            background-color: #c0c0c0;
            padding: 20px;
            border: 4px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.5);
            text-align: center;
            max-width: 300px;
            width: 80%;
        }
        
        .victory-content h2 {
            color: #000;
            margin: 0 0 15px 0;
            font-size: 24px;
            text-shadow: 1px 1px 0 #fff;
        }
        
        .victory-stats {
            background-color: #c0c0c0;
            border: 2px solid #808080;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.5;
            text-align: left; /* å·¦å¯¹é½ç»Ÿè®¡ä¿¡æ¯ */
        }
        
        .victory-stats div {
            margin-bottom: 5px;
        }
        
        .victory-stats div:last-child {
            margin-bottom: 0;
        }
        
        .victory-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .victory-button {
            padding: 8px 15px;
            background-color: #c0c0c0;
            border: 3px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            font-weight: bold;
            cursor: pointer;
            min-width: 80px;
        }
        
        .victory-button:active {
            border-color: #808080 #ffffff #ffffff #808080;
        }
        
        .victory-emoji {
            font-size: 40px;
            margin-bottom: 10px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="page-container">
        <h1>ç»å…¸æ‰«é›·æ¸¸æˆ</h1>
        
        <div class="difficulty-selector">
            <button onclick="startGame(9, 9, 10)">åˆçº§ (9Ã—9, 10é›·)</button>
            <button onclick="startGame(16, 16, 40)">ä¸­çº§ (16Ã—16, 40é›·)</button>
            <button onclick="startGame(30, 16, 99)">é«˜çº§ (30Ã—16, 99é›·)</button>
        </div>
        
        <div class="game-container">
            <div class="game-header">
                <div class="counter" id="mine-counter">010</div>
                <button class="face-button" id="face-button" onclick="resetGame()">ğŸ˜Š</button>
                <div class="counter" id="timer">000</div>
            </div>
            <div class="game-board" id="game-board"></div>
        </div>
        
        <div class="instructions">
            <h2>æ‰«é›·æ¸¸æˆç©æ³•è¯´æ˜</h2>
            
            <h3>æ¸¸æˆç›®æ ‡</h3>
            <p>åœ¨ä¸è§¦é›·çš„æƒ…å†µä¸‹ï¼Œæ­ç¤ºæ‰€æœ‰éåœ°é›·æ ¼å­ã€‚</p>
            
            <h3>åŸºæœ¬æ“ä½œ</h3>
            <ul>
                <li><strong>ç‚¹å‡»æ ¼å­</strong>ï¼šæ­ç¤ºè¯¥æ ¼å­</li>
                <li><strong>é•¿æŒ‰æˆ–å³å‡»æ ¼å­</strong>ï¼šæ ‡è®°/å–æ¶ˆæ ‡è®°ä¸ºåœ°é›·</li>
                <li><strong>æ•°å­—</strong>ï¼šè¡¨ç¤ºå‘¨å›´8ä¸ªæ ¼å­ä¸­çš„åœ°é›·æ•°é‡</li>
                <li><strong>ç¬¬ä¸€æ¬¡ç‚¹å‡»</strong>ï¼šæ°¸è¿œä¸ä¼šç‚¹åˆ°åœ°é›·</li>
            </ul>
            
            <h3>æ¸¸æˆç­–ç•¥</h3>
            <ul>
                <li>ä»æ•°å­—1å¼€å§‹ï¼Œé€æ­¥æ¨ç†å‘¨å›´åœ°é›·ä½ç½®</li>
                <li>å½“ç¡®å®šæŸæ ¼æ˜¯åœ°é›·æ—¶ï¼Œé•¿æŒ‰æ ‡è®°å®ƒ</li>
                <li>å½“æŸæ ¼å‘¨å›´çš„åœ°é›·éƒ½å·²æ ‡è®°ï¼Œå¯ä»¥å¿«é€Ÿç‚¹å‡»æ­ç¤ºå‘¨å›´æ ¼å­</li>
                <li>ä¸ç¡®å®šæ—¶ï¼Œå¯ä»¥å…ˆæ­ç¤ºå…¶ä»–åŒºåŸŸ</li>
            </ul>
            
            <h3>æ¸¸æˆçŠ¶æ€</h3>
            <ul>
                <li>ğŸ˜Šï¼šæ¸¸æˆè¿›è¡Œä¸­</li>
                <li>ğŸ˜®ï¼šç‚¹å‡»æ ¼å­æ—¶</li>
                <li>ğŸ˜µï¼šè¸©åˆ°åœ°é›·ï¼Œæ¸¸æˆå¤±è´¥</li>
                <li>ğŸ˜ï¼šæ¸¸æˆèƒœåˆ©</li>
            </ul>
        </div>
		<!-- åœ¨bodyåº•éƒ¨æ·»åŠ èƒœåˆ©å¼¹çª—HTML -->
		<!-- èƒœåˆ©å¼¹çª—HTML -->
		<div class="victory-modal" id="victory-modal">
			<div class="victory-content">
				<span class="victory-emoji">ğŸ†</span>
				<h2>æ‰«é›·æˆåŠŸ!</h2>
				
				<div class="victory-stats" id="victory-stats">
					<!-- è¿™é‡Œä¼šåŠ¨æ€æ’å…¥æ¸¸æˆç»Ÿè®¡ä¿¡æ¯ -->
				</div>
				
				<div class="victory-buttons">
					<button class="victory-button" onclick="resetGame();document.getElementById('victory-modal').style.display='none'">
						å†ç©ä¸€æ¬¡
					</button>
					<button class="victory-button" onclick="document.getElementById('victory-modal').style.display='none'">
						æŸ¥çœ‹æ£‹ç›˜
					</button>
				</div>
			</div>
		</div>
	
	
    </div>
    
    <script>
        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            rows: 9,
            cols: 9,
            mines: 10,
            board: [],
            revealed: [],
            flagged: [],
            gameOver: false,
            gameWon: false,
            firstClick: true,
            timer: 0,
            timerInterval: null,
            minesLeft: 10,
            touchStartTime: 0,
            touchStartIndex: -1
        };
        
        // DOMå…ƒç´ 
        const gameBoard = document.getElementById('game-board');
        const mineCounter = document.getElementById('mine-counter');
        const timerDisplay = document.getElementById('timer');
        const faceButton = document.getElementById('face-button');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function startGame(rows, cols, mines) {
            // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
            }
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            gameState.rows = rows;
            gameState.cols = cols;
            gameState.mines = mines;
            gameState.board = [];
            gameState.revealed = Array(rows * cols).fill(false);
            gameState.flagged = Array(rows * cols).fill(false);
            gameState.gameOver = false;
            gameState.gameWon = false;
            gameState.firstClick = true;
            gameState.timer = 0;
            gameState.minesLeft = mines;
            
            // æ›´æ–°UI
            updateMineCounter();
            updateTimer();
            faceButton.textContent = 'ğŸ˜Š';
            
            // è®¾ç½®æ¸¸æˆæ¿æ ·å¼
            gameBoard.style.setProperty('--rows', rows);
            gameBoard.style.setProperty('--cols', cols);
            
            // åˆ›å»ºæ¸¸æˆæ¿
            gameBoard.innerHTML = '';
            for (let i = 0; i < rows * cols; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
                cell.addEventListener('click', () => handleCellClick(i));
                
                // æ·»åŠ å³é”®/é•¿æŒ‰äº‹ä»¶ç›‘å¬å™¨
                cell.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    handleRightClick(i);
                });
                
                // è§¦æ‘¸äº‹ä»¶å¤„ç†
                cell.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    gameState.touchStartTime = Date.now();
                    gameState.touchStartIndex = i;
                    
                    // æ˜¾ç¤ºæŒ‰ä¸‹çŠ¶æ€
                    if (!gameState.gameOver && !gameState.gameWon && !gameState.flagged[i]) {
                        faceButton.textContent = 'ğŸ˜®';
                    }
                });
                
                cell.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    const touchDuration = Date.now() - gameState.touchStartTime;
                    
                    if (gameState.touchStartIndex === i) {
                        if (touchDuration > 500) { // é•¿æŒ‰
                            handleRightClick(i);
                        } else { // çŸ­æŒ‰
                            handleCellClick(i);
                        }
                    }
                    
                    // æ¢å¤ç¬‘è„¸
                    if (!gameState.gameOver && !gameState.gameWon) {
                        faceButton.textContent = 'ğŸ˜Š';
                    }
                    
                    gameState.touchStartIndex = -1;
                });
                
                cell.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    // å¦‚æœç§»åŠ¨è·ç¦»è¾ƒå¤§ï¼Œå–æ¶ˆå½“å‰è§¦æ‘¸
                    gameState.touchStartIndex = -1;
                });
                
                // é¼ æ ‡æŒ‰ä¸‹å’ŒæŠ¬èµ·äº‹ä»¶
                cell.addEventListener('mousedown', () => {
                    if (!gameState.gameOver && !gameState.gameWon && !gameState.flagged[i]) {
                        faceButton.textContent = 'ğŸ˜®';
                    }
                });
                
                cell.addEventListener('mouseup', () => {
                    if (!gameState.gameOver && !gameState.gameWon) {
                        faceButton.textContent = 'ğŸ˜Š';
                    }
                });
                
                cell.addEventListener('mouseleave', () => {
                    if (!gameState.gameOver && !gameState.gameWon) {
                        faceButton.textContent = 'ğŸ˜Š';
                    }
                });
                
                gameBoard.appendChild(cell);
            }
        }
        
        // é‡ç½®æ¸¸æˆï¼ˆä¿æŒç›¸åŒéš¾åº¦ï¼‰
        function resetGame() {
            startGame(gameState.rows, gameState.cols, gameState.mines);
        }
        
        // ç”Ÿæˆæ¸¸æˆæ¿ï¼ˆåœ¨ç¬¬ä¸€æ¬¡ç‚¹å‡»åï¼‰
        function generateBoard(firstClickIndex) {
            // åˆå§‹åŒ–ç©ºç™½æ¿
            gameState.board = Array(gameState.rows * gameState.cols).fill(0);
            
            // æ”¾ç½®åœ°é›·
            let minesPlaced = 0;
            while (minesPlaced < gameState.mines) {
                const randomIndex = Math.floor(Math.random() * gameState.rows * gameState.cols);
                
                // ç¡®ä¿ä¸åœ¨ç¬¬ä¸€æ¬¡ç‚¹å‡»çš„ä½ç½®åŠå…¶å‘¨å›´æ”¾ç½®åœ°é›·
                if (randomIndex !== firstClickIndex && 
                    !isAdjacent(firstClickIndex, randomIndex) && 
                    gameState.board[randomIndex] !== -1) {
                    gameState.board[randomIndex] = -1; // -1 è¡¨ç¤ºåœ°é›·
                    minesPlaced++;
                    
                    // å¢åŠ ç›¸é‚»æ ¼å­çš„æ•°å­—
                    const [row, col] = indexToPosition(randomIndex);
                    for (let r = Math.max(0, row - 1); r <= Math.min(gameState.rows - 1, row + 1); r++) {
                        for (let c = Math.max(0, col - 1); c <= Math.min(gameState.cols - 1, col + 1); c++) {
                            const index = positionToIndex(r, c);
                            if (gameState.board[index] !== -1) {
                                gameState.board[index]++;
                            }
                        }
                    }
                }
            }
            
            // å¼€å§‹è®¡æ—¶
            startTimer();
        }
        
        // æ£€æŸ¥ä¸¤ä¸ªæ ¼å­æ˜¯å¦ç›¸é‚»
        function isAdjacent(index1, index2) {
            const [r1, c1] = indexToPosition(index1);
            const [r2, c2] = indexToPosition(index2);
            return Math.abs(r1 - r2) <= 1 && Math.abs(c1 - c2) <= 1;
        }
        
        // å¤„ç†æ ¼å­ç‚¹å‡»
        function handleCellClick(index) {
            if (gameState.gameOver || gameState.gameWon || gameState.flagged[index]) {
                return;
            }
            
            // ç¬¬ä¸€æ¬¡ç‚¹å‡»ç”Ÿæˆæ¸¸æˆæ¿
            if (gameState.firstClick) {
                generateBoard(index);
                gameState.firstClick = false;
            }
            
            // å¦‚æœç‚¹åˆ°åœ°é›·ï¼Œæ¸¸æˆç»“æŸ
            if (gameState.board[index] === -1) {
                revealAllMines();
                gameState.gameOver = true;
                faceButton.textContent = 'ğŸ˜µ';
                return;
            }
            
            // æ­ç¤ºæ ¼å­
            revealCell(index);
            
            // æ£€æŸ¥æ˜¯å¦èƒœåˆ©
            checkWin();
        }
        
        // å¤„ç†å³é”®ç‚¹å‡»/é•¿æŒ‰ï¼ˆæ’æ——ï¼‰
        function handleRightClick(index) {
            if (gameState.gameOver || gameState.gameWon || gameState.revealed[index]) {
                return;
            }
            
            // åˆ‡æ¢æ’æ——çŠ¶æ€
            gameState.flagged[index] = !gameState.flagged[index];
            
            // æ›´æ–°UI
            const cell = gameBoard.children[index];
            if (gameState.flagged[index]) {
                cell.textContent = 'ğŸš©';
                gameState.minesLeft--;
            } else {
                cell.textContent = '';
                gameState.minesLeft++;
            }
            
            updateMineCounter();
            
            // æ£€æŸ¥æ˜¯å¦èƒœåˆ©
            checkWin();
        }
        
        // æ­ç¤ºæ ¼å­
        function revealCell(index) {
            if (gameState.revealed[index] || gameState.flagged[index]) {
                return;
            }
            
            gameState.revealed[index] = true;
            const cell = gameBoard.children[index];
            cell.classList.add('revealed');
            
            // æ˜¾ç¤ºæ ¼å­å†…å®¹
            if (gameState.board[index] === -1) {
                cell.textContent = 'ğŸ’£';
                cell.classList.add('mine');
            } else if (gameState.board[index] > 0) {
                cell.textContent = gameState.board[index];
                cell.classList.add(`number-${gameState.board[index]}`);
            } else {
                // å¦‚æœæ˜¯ç©ºç™½æ ¼å­ï¼Œé€’å½’æ­ç¤ºå‘¨å›´çš„æ ¼å­
                const [row, col] = indexToPosition(index);
                for (let r = Math.max(0, row - 1); r <= Math.min(gameState.rows - 1, row + 1); r++) {
                    for (let c = Math.max(0, col - 1); c <= Math.min(gameState.cols - 1, col + 1); c++) {
                        const neighborIndex = positionToIndex(r, c);
                        if (neighborIndex !== index && !gameState.revealed[neighborIndex]) {
                            revealCell(neighborIndex);
                        }
                    }
                }
            }
        }
        
        // æ­ç¤ºæ‰€æœ‰åœ°é›·ï¼ˆæ¸¸æˆç»“æŸæ—¶ï¼‰
        function revealAllMines() {
            for (let i = 0; i < gameState.rows * gameState.cols; i++) {
                if (gameState.board[i] === -1) {
                    const cell = gameBoard.children[i];
                    cell.textContent = 'ğŸ’£';
                    cell.classList.add('mine');
                }
            }
        }
        
        // æ›´æ–°checkWinå‡½æ•°
        function checkWin() {
            let allNonMinesRevealed = true;
            for (let i = 0; i < gameState.rows * gameState.cols; i++) {
                if (gameState.board[i] !== -1 && !gameState.revealed[i]) {
                    allNonMinesRevealed = false;
                    break;
                }
            }
            
            let allMinesFlagged = true;
            for (let i = 0; i < gameState.rows * gameState.cols; i++) {
                if (gameState.board[i] === -1 && !gameState.flagged[i]) {
                    allMinesFlagged = false;
                    break;
                }
            }
            
            if (allNonMinesRevealed || allMinesFlagged) {
                gameState.gameWon = true;
                faceButton.textContent = 'ğŸ˜';
                clearInterval(gameState.timerInterval);
                
                // æ˜¾ç¤ºæ‰€æœ‰åœ°é›·å’Œæœªæ­ç¤ºçš„å®‰å…¨æ ¼å­
                revealFinalBoard();
                
                // æ˜¾ç¤ºèƒœåˆ©å¼¹çª—
                showVictoryMessage();
            }
        }
        
        // æ–°å¢å‡½æ•°ï¼šæ˜¾ç¤ºæœ€ç»ˆæ£‹ç›˜çŠ¶æ€
        function revealFinalBoard() {
            for (let i = 0; i < gameState.rows * gameState.cols; i++) {
                const cell = gameBoard.children[i];
                
                if (gameState.board[i] === -1) {
                    // åœ°é›·æ ¼å­ï¼šæ˜¾ç¤ºåœ°é›·æˆ–æ——å¸œ
                    if (!gameState.flagged[i]) {
                        cell.textContent = 'ğŸ’£';
                        cell.classList.add('mine');
                    } else {
                        cell.textContent = 'ğŸš©';
                    }
                    cell.classList.add('revealed');
                } else if (!gameState.revealed[i]) {
                    // æœªæ­ç¤ºçš„å®‰å…¨æ ¼å­ï¼šæ˜¾ç¤ºæ•°å­—æˆ–ç©ºç™½
                    cell.classList.add('revealed');
                    if (gameState.board[i] > 0) {
                        cell.textContent = gameState.board[i];
                        cell.classList.add(`number-${gameState.board[i]}`);
                    }
                }
            }
        }
        
        // æ›´æ–°showVictoryMessageå‡½æ•°
        function showVictoryMessage() {
            const modal = document.getElementById('victory-modal');
            const stats = document.getElementById('victory-stats');
            
            // è·å–éš¾åº¦åç§°
            let difficulty = '';
            if (gameState.rows === 9 && gameState.cols === 9 && gameState.mines === 10) {
                difficulty = 'åˆçº§ (9Ã—9, 10é›·)';
            } else if (gameState.rows === 16 && gameState.cols === 16 && gameState.mines === 40) {
                difficulty = 'ä¸­çº§ (16Ã—16, 40é›·)';
            } else {
                difficulty = 'é«˜çº§ (30Ã—16, 99é›·)';
            }
            
            stats.innerHTML = `<div><strong>éš¾åº¦:</strong> ${difficulty}ï¼Œ<strong>ç”¨æ—¶:</strong> ${gameState.timer}ç§’</div>`;
            
            modal.style.display = 'flex';
        }
        
        // å¼€å§‹è®¡æ—¶å™¨
        function startTimer() {
            gameState.timer = 0;
            updateTimer();
            clearInterval(gameState.timerInterval);
            gameState.timerInterval = setInterval(() => {
                gameState.timer++;
                updateTimer();
                
                // è®¡æ—¶å™¨æœ€å¤§å€¼999
                if (gameState.timer >= 999) {
                    clearInterval(gameState.timerInterval);
                }
            }, 1000);
        }
        
        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimer() {
            timerDisplay.textContent = gameState.timer.toString().padStart(3, '0');
        }
        
        // æ›´æ–°åœ°é›·è®¡æ•°å™¨
        function updateMineCounter() {
            mineCounter.textContent = Math.min(999, Math.max(0, gameState.minesLeft)).toString().padStart(3, '0');
        }
        
        // è¾…åŠ©å‡½æ•°ï¼šç´¢å¼•è½¬è¡Œåˆ—
        function indexToPosition(index) {
            const row = Math.floor(index / gameState.cols);
            const col = index % gameState.cols;
            return [row, col];
        }
        
        // è¾…åŠ©å‡½æ•°ï¼šè¡Œåˆ—è½¬ç´¢å¼•
        function positionToIndex(row, col) {
            return row * gameState.cols + col;
        }
        
        // åˆå§‹åŒ–æ¸¸æˆï¼ˆåˆçº§éš¾åº¦ï¼‰
        startGame(9, 9, 10);
    </script>
</body>
</html>
